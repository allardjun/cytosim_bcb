% A bead propelled by a beating flagella
% F. Nedelec, 18.04.2013

set simul system
{
    time_step = 0.001
    viscosity = 0.2
    steric = 1, 500, 500
}

set system display
{
    delay = 3;
    style = 2;
    point_size = 8; 
    window_size = 1024, 512; 
}

set space cell
{
    shape = rectangle
    display = ( visible=0; width=1; )
}

set fiber microtubule
{
    rigidity = 30
    segmentation = 0.200
    steric = 1, 0.1, 0.25   
    display = ( color=blue; line_width=3; )
}

set hand binder 
{
    binding = 1000, 0.25
    unbinding = 0, inf
    display = ( width=6; size=8; color=blue, dark_blue )
}

set single linker
{
    hand = binder
    stiffness = 5000
}

set hand dynein 
{
    binding = 0, 0.4
    unbinding = 0.1, 1.2
    
    activity = move
    unloaded_speed = -1
    stall_force = 5

    display = ( width=5; size=10; color=white; )
}

set couple motor 
{
    hand1 = binder
    hand2 = dynein
    diffusion = 0
    stiffness = 1000
    length = 0.2
}

set solid head
{
    display = ( style=5; )
}


new cell
{
    length = 16, 8
}

new head
{
    point1 = 0    0   0, 0.8
    point2 = 0.0  0.1 0
    point3 = 0.8  0.1 0
    point4 = 0.0 -0.1 0
    point5 = 0.8 -0.1 0
    position = -5.0 0 0
    orientation = 1 0 0
}

new microtubule
{
    position = 0 0.1 0
    orientation = 1 0 0
    length = 10
}

new linker
{
    base = solid1, point2
    attach = fiber1, 0
}

new linker
{
    base = solid1, point3
    attach = fiber1, 0.8
}

new microtubule
{
    position = 0 -0.1 0
    orientation = 1 0 0
    length = 10
}

new linker
{
    base = solid1, point4
    attach = fiber2, 0
}

new linker
{
    base = solid1, point5
    attach = fiber2, 0.8
}

new 100 motor
{
    distribute = -4.2 0.2 0, 5 0.2 0
}

new 100 motor
{
    distribute = -4.175 -0.2 0, 5 -0.2 0
}

run 100 system
{
    solve = 0
}

set dynein { binding_rate = 5 }

run 100000 system
{
    nb_frames = 100
}
